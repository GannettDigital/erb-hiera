#!/usr/bin/env ruby
require 'opentelemetry/sdk'
require 'opentelemetry/exporter/otlp'
require 'opentelemetry/instrumentation/net/http'
OpenTelemetry::SDK.configure do |c|
  c.service_name = 'erb-hiera'
  c.use 'OpenTelemetry::Instrumentation::Net::HTTP'
end

tracer = OpenTelemetry.tracer_provider.tracer('erb-hiera')
tracer.in_span(ENV.fetch('namespacebase')) do

  $LOAD_PATH.unshift(File.join(File.dirname(__FILE__), "../lib"))

  require "erb-hiera"

  ErbHiera.run
end
